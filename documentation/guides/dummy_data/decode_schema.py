import pyarrow as pa

# Replace with your actual hex string
hex_str = "fffffffff80000001000000000000a000c000a00090004000a000000100000000001040008000800000004000800000004000000030000009000000050000000140000001000160010000e000f0004000000080010000000180000001c000000000001031800000000000600080006000600000000000200000000000900000074696d657374616d70000000d4ffffff180000000c0000000000010510000000000000000400040004000000050000006576656e740000001000140010000e000f00040000000800100000001800000020000000000001021c00000008000c0004000b000800000040000000000000010000000007000000757365725f696400"
data = bytes.fromhex(hex_str)

# Read schema from IPC message
schema = pa.ipc.read_schema(pa.BufferReader(data))
print(schema)

